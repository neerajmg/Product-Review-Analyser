<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Settings</title>
  <link rel="stylesheet" href="../../styles.css" />
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 16px; max-width: 720px; }
    label { display:block; margin:12px 0 4px; font-weight:600; }
  input[type=text], input[type=number] { width: 420px; padding:6px; }
  .narrow-num { width:140px !important; }
    .row { margin-bottom: 12px; }
    .toggle { width:auto; }
    #saveStatus { font-size:12px; color:#555; }
    fieldset { border:1px solid #ccc; padding:12px; }
    legend { font-weight:600; }
  </style>
</head>
<body>
  <h1>Review Analyzer — Settings</h1>
  <p class="ppc-opt-intro">
    <strong>Gemini API Key Setup:</strong><br>
  1) Visit <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener">Google AI Studio – API Keys</a> and create a key (ensure billing/quota enabled).<br>
    2) Paste the key below and click <em>Save</em>, then <em>Validate Key</em>.<br>
    3) Status indicator will show <code>VALID</code>, <code>INVALID</code>, <code>QUOTA EXHAUSTED</code>, or network errors.<br>
    4) If quota is exhausted or key expires, the extension shows a red badge (!) and an in-page toast when active.<br>
    <br>
    <strong>Fallback mode:</strong> If enabled, only the local deterministic summarizer runs (no API calls).<br>
    <strong>Max pages:</strong> Default deep crawl limit (asks for confirmation when >100).<br>
    <strong>Security:</strong> Key is stored only via Chrome storage on this browser. It is never sent anywhere except directly to the Gemini API endpoint when summarizing.
  </p>

  <fieldset>
    <legend>Configuration</legend>
    <div class="row">
      <label for="apiKey">Gemini API Key</label>
      <input id="apiKey" type="text" placeholder="Paste key (optional)" />
      <button id="saveBtn" class="ppc-inline-btn-margin">Save</button>
      <button id="testKeyBtn">Validate Key</button>
    </div>
    <div class="row ppc-small-text">
      Key Status: <span id="keyStatus">(not checked)</span>
      <button id="recheckBtn" class="ppc-inline-btn-left">Re-check</button>
    </div>
    <div class="row">
      <label><input id="fallbackMode" type="checkbox" class="toggle" /> Fallback mode (local summarizer only)</label>
    </div>
    <div class="row">
      <label for="maxPagesCap">Max pages per deep crawl (5–100, default 60)</label>
      <input id="maxPagesCap" class="narrow-num" type="number" min="5" max="100" step="1" placeholder="60" />
    </div>
    <div class="row">
      <label for="maxReviewCount">Max total reviews aggregated (200–2500, default 1200)</label>
      <input id="maxReviewCount" class="narrow-num" type="number" min="200" max="2500" step="50" placeholder="1200" />
    </div>
    <div class="row">
      <span id="saveStatus"></span>
    </div>
  </fieldset>

  <script src="options.js"></script>
</body>
</html>
